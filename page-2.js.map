{"version":3,"file":"page-2.js","sources":["../src/js/gallery.js"],"sourcesContent":["const API_KEY = \"53000843-fe64c924bebc5f4f776b5f2a3\";\nconst BASE_URL = \"https://pixabay.com/api/\";\n\nconst form = document.querySelector(\"#search-form\");\nconst gallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\");\nconst loadMoreBtn = document.querySelector(\"#load-more\");\n\nconst lightbox = new SimpleLightbox(\".gallery a\", {\n  captionsData: \"alt\",\n  captionDelay: 250,\n});\n\nlet currentQuery = \"\";\nlet currentPage = 1;\nconst perPage = 20;\n\nform.addEventListener(\"submit\", handleSearch);\nloadMoreBtn.addEventListener(\"click\", handleLoadMore);\n\nasync function handleSearch(e) {\n  e.preventDefault();\n  const query = e.target.elements.searchQuery.value.trim();\n\n  if (!query) {\n    iziToast.warning({\n      message: \"Please enter a search term!\",\n      position: \"topRight\",\n    });\n    return;\n  }\n\n  currentQuery = query;\n  currentPage = 1;\n  gallery.innerHTML = \"\";\n  await fetchAndRenderImages();\n}\n\nasync function handleLoadMore() {\n  currentPage += 1;\n  await fetchAndRenderImages();\n}\n\nasync function fetchAndRenderImages() {\n  loader.style.display = \"block\";\n  loadMoreBtn.style.display = \"none\";\n\n  try {\n    const data = await fetchImages(currentQuery, currentPage);\n    loader.style.display = \"none\";\n\n    if (data.hits.length === 0 && currentPage === 1) {\n      iziToast.info({\n        message: \"No images found. Try another search term!\",\n        position: \"topRight\",\n      });\n      return;\n    }\n\n    const markup = renderGallery(data.hits);\n    gallery.insertAdjacentHTML(\"beforeend\", markup);\n    lightbox.refresh();\n\n    const totalPages = Math.ceil(data.totalHits / perPage);\n    if (currentPage < totalPages) {\n      loadMoreBtn.style.display = \"block\";\n    } else {\n      iziToast.info({\n        message: \"You've reached the end of search results!\",\n        position: \"topRight\",\n      });\n      loadMoreBtn.style.display = \"none\";\n    }\n  } catch (error) {\n    loader.style.display = \"none\";\n    iziToast.error({\n      message: \"Something went wrong. Please try again!\",\n      position: \"topRight\",\n    });\n    console.error(\"Fetch error:\", error);\n  }\n}\n\nasync function fetchImages(query, page) {\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: \"true\",\n    per_page: perPage,\n    page: page,\n  });\n\n  const res = await fetch(`${BASE_URL}?${params}`);\n  if (!res.ok) throw new Error(\"HTTP Error: \" + res.status);\n  return await res.json();\n}\n\nfunction renderGallery(images) {\n  return images\n    .map(\n      img => `\n      <li class=\"gallery-item\">\n        <a href=\"${img.largeImageURL}\">\n          <img src=\"${img.webformatURL}\" alt=\"${img.tags}\" loading=\"lazy\" />\n        </a>\n        <div class=\"info\">\n          <p><b>Likes</b> ${img.likes}</p>\n          <p><b>Views</b> ${img.views}</p>\n          <p><b>Comments</b> ${img.comments}</p>\n          <p><b>Downloads</b> ${img.downloads}</p>\n        </div>\n      </li>\n    `\n    )\n    .join(\"\");\n}\n"],"names":["API_KEY","BASE_URL","form","gallery","loader","loadMoreBtn","lightbox","currentQuery","currentPage","perPage","handleSearch","handleLoadMore","e","query","fetchAndRenderImages","data","fetchImages","markup","renderGallery","totalPages","error","page","params","res","images","img"],"mappings":"wFAAA,MAAMA,EAAU,qCACVC,EAAW,2BAEXC,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,YAAY,EAEjDC,EAAW,IAAI,eAAe,aAAc,CAChD,aAAc,MACd,aAAc,GAChB,CAAC,EAED,IAAIC,EAAe,GACfC,EAAc,EAClB,MAAMC,EAAU,GAEhBP,EAAK,iBAAiB,SAAUQ,CAAY,EAC5CL,EAAY,iBAAiB,QAASM,CAAc,EAEpD,eAAeD,EAAaE,EAAG,CAC7BA,EAAE,eAAc,EAChB,MAAMC,EAAQD,EAAE,OAAO,SAAS,YAAY,MAAM,OAElD,GAAI,CAACC,EAAO,CACV,SAAS,QAAQ,CACf,QAAS,8BACT,SAAU,UAChB,CAAK,EACD,MACD,CAEDN,EAAeM,EACfL,EAAc,EACdL,EAAQ,UAAY,GACpB,MAAMW,EAAoB,CAC5B,CAEA,eAAeH,GAAiB,CAC9BH,GAAe,EACf,MAAMM,EAAoB,CAC5B,CAEA,eAAeA,GAAuB,CACpCV,EAAO,MAAM,QAAU,QACvBC,EAAY,MAAM,QAAU,OAE5B,GAAI,CACF,MAAMU,EAAO,MAAMC,EAAYT,EAAcC,CAAW,EAGxD,GAFAJ,EAAO,MAAM,QAAU,OAEnBW,EAAK,KAAK,SAAW,GAAKP,IAAgB,EAAG,CAC/C,SAAS,KAAK,CACZ,QAAS,4CACT,SAAU,UAClB,CAAO,EACD,MACD,CAED,MAAMS,EAASC,EAAcH,EAAK,IAAI,EACtCZ,EAAQ,mBAAmB,YAAac,CAAM,EAC9CX,EAAS,QAAO,EAEhB,MAAMa,EAAa,KAAK,KAAKJ,EAAK,UAAYN,CAAO,EACjDD,EAAcW,EAChBd,EAAY,MAAM,QAAU,SAE5B,SAAS,KAAK,CACZ,QAAS,4CACT,SAAU,UAClB,CAAO,EACDA,EAAY,MAAM,QAAU,OAE/B,OAAQe,EAAO,CACdhB,EAAO,MAAM,QAAU,OACvB,SAAS,MAAM,CACb,QAAS,0CACT,SAAU,UAChB,CAAK,EACD,QAAQ,MAAM,eAAgBgB,CAAK,CACpC,CACH,CAEA,eAAeJ,EAAYH,EAAOQ,EAAM,CACtC,MAAMC,EAAS,IAAI,gBAAgB,CACjC,IAAKtB,EACL,EAAGa,EACH,WAAY,QACZ,YAAa,aACb,WAAY,OACZ,SAAUJ,EACV,KAAMY,CACV,CAAG,EAEKE,EAAM,MAAM,MAAM,GAAGtB,CAAQ,IAAIqB,CAAM,EAAE,EAC/C,GAAI,CAACC,EAAI,GAAI,MAAM,IAAI,MAAM,eAAiBA,EAAI,MAAM,EACxD,OAAO,MAAMA,EAAI,MACnB,CAEA,SAASL,EAAcM,EAAQ,CAC7B,OAAOA,EACJ,IACCC,GAAO;AAAA;AAAA,mBAEMA,EAAI,aAAa;AAAA,sBACdA,EAAI,YAAY,UAAUA,EAAI,IAAI;AAAA;AAAA;AAAA,4BAG5BA,EAAI,KAAK;AAAA,4BACTA,EAAI,KAAK;AAAA,+BACNA,EAAI,QAAQ;AAAA,gCACXA,EAAI,SAAS;AAAA;AAAA;AAAA,KAIxC,EACA,KAAK,EAAE,CACZ"}